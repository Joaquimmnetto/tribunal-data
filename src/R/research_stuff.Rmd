 [---
title: "Research Stuff"
output:
  pdf_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
setwd("~/PyCharm-Workspace/tribunaldb/")
require(data.table)
require(ggplot2)
require(pcaPP)
load('something.RData')
source("src/R/utils.R")

	names = list(ally='Ally', ec='Cont. Enemy', nc='Non-Cont.', offender='Offender', enemy='Enemy')
	colors = create.color.scale('Groups', names)
	
	#names = list(ally='Ally', enemy='Enemy')
	#colors = create.color.scale('Groups', names)

# Line types should be specified with either an integer, a name, or with a string of
# an even number (up to eight) of hexadecimal digits which give the lengths in
# consecutive positions in the string.
# 0 = blank, 1 = solid, 2 = dashed, 3 = dotted, 4 = dotdash, 5 = longdash, 6 = twodash
	plot.topic.perf <- function(col.name){
			plt <- add.theme(
			ggplot() + 
			geom_smooth(data=ally.topics.perf, aes(x=performance, y=get(col.name) * 100, color=names$ally)) +
			geom_point(data=ally.topics.perf, aes(x=performance, y=get(col.name) * 100, color=names$ally), alpha=0.5) + 
			geom_smooth(data=enemy.topics.perf, aes(x=performance, y=get(col.name) * 100, color=names$enemy)) +
			geom_point(data=enemy.topics.perf, aes(x=performance, y=get(col.name) * 100, color=names$enemy), alpha=0.5) +
			# 	geom_smooth(data=ec.topics.perf, aes(x=values, y=get(col.name) * 100, color=names$ec)) +
			# 	geom_point(data=ec.topics.perf, aes(x=values, y=get(col.name) * 100, color=names$ec), alpha=0.5) +
			# geom_smooth(data=nc.topics.perf, aes(x=values, y=get(col.name) * 100, color=names$nc)) +
			# 	geom_point(data=nc.topics.perf, aes(x=values, y=get(col.name) * 100, color=names$nc), alpha=0.5) + 
			geom_smooth(data=offender.topics.perf, aes(x=performance, y=get(col.name) * 100, color=names$offender)) +
				geom_point(data=offender.topics.perf, aes(x=performance, y=get(col.name) * 100, color=names$offender), alpha=0.5)
			,col.scale = colors)
			
			return(plt)
	}	
	plot.topic.offender.perf <- function(col.name){
			plt <- add.theme(
			ggplot() + 
			geom_smooth(data=offender.ally.topics.perf, aes(x=performance, y=get(col.name) * 100, color=names$ally)) +
				geom_point(data=offender.ally.topics.perf, aes(x=performance, y=get(col.name) * 100, color=names$ally), alpha=0.5) + 
			geom_smooth(data=offender.ec.topics.perf, aes(x=values, y=get(col.name) * 100, color=names$ec)) +
				geom_point(data=offender.ec.topics.perf, aes(x=values, y=get(col.name) * 100, color=names$ec), alpha=0.5) +
			geom_smooth(data=offender.nc.topics.perf, aes(x=values, y=get(col.name) * 100, color=names$nc)) +
				geom_point(data=offender.nc.topics.perf, aes(x=values, y=get(col.name) * 100, color=names$nc), alpha=0.5)  
			#+ geom_smooth(data=offender.topics.perf, aes(x=performance, y=get(col.name) * 100, color=names$offender)) 
			#+ geom_point(data=offender.topics.perf, aes(x=performance, y=get(col.name) * 100, color=names$offender), alpha=0.5)
			,col.scale = colors)
			
			return(plt)
	}	

	plot.topic.cont <- function(col.name){
		plt <- add.theme(
			ggplot() + 
			geom_smooth(data=ally.topics.cont, aes(x=contamination, y=get(col.name) * 100, color=names$ally),span=1) +
			 geom_point(data=ally.topics.cont, aes(x=contamination, y=get(col.name) * 100, color=names$ally),alpha=0.5) + 
			geom_smooth(data=enemy.topics.cont, aes(x=contamination, y=get(col.name) * 100, color=names$enemy),span=1) +
			 geom_point(data=enemy.topics.cont, aes(x=contamination, y=get(col.name) * 100, color=names$enemy),alpha=0.5)
			,col.scale = colors)
		return(plt)
	}
	plot.topic.offender.cont <- function(col.name){
		plt <- add.theme(
			ggplot() + 
			geom_smooth(data=offender.ally.topics.cont, aes(x=contamination, y=get(col.name) * 100, color=names$ally),span=1) +
			 geom_point(data=offender.ally.topics.cont, aes(x=contamination, y=get(col.name) * 100, color=names$ally),alpha=0.5) + 
			geom_smooth(data=offender.enemy.topics.cont, aes(x=contamination, y=get(col.name) * 100, color=names$enemy),span=1) +
			 geom_point(data=offender.enemy.topics.cont, aes(x=contamination, y=get(col.name) * 100, color=names$enemy),alpha=0.5)
			,col.scale = colors)
		return(plt)
	}

	
	correlations.perf <- function(col.name){
		print("Todos:")
		print(with(topics.perf, cor.fk(performance, get(col.name))))
		print("Não Contaminados:")
		print(with(nc.topics.perf, cor.fk(values, get(col.name))))
		print("Inimigos Contaminados:")
		print(with(ec.topics.perf, cor.fk(values, get(col.name))))
		print("Aliados:")
		print(with(ally.topics.perf, cor.fk(performance, get(col.name))))
		print("Ofensor:")
		print(with(offender.topics.perf, cor.fk(performance, get(col.name))))
		#print("Inimigos Totais:")
		#print(with(enemy.topics.perf, cor.fk(performance, get(col.name))))
		
	}
	offender.correlations.perf <- function(col.name){
		print("Não Contaminados:")
		print(with(offender.nc.topics.perf, cor.fk(values, get(col.name))))
		print("Inimigos Contaminados:")
		print(with(offender.ec.topics.perf, cor.fk(values, get(col.name))))
		print("Aliados:")
		print(with(offender.ally.topics.perf, cor.fk(performance, get(col.name))))
		#print("Ofensor:")
		#print(with(offender.topics.perf, cor.fk(performance, get(col.name))))
		#print("Inimigos Totais:")
		#print(with(enemy.topics.perf, cor.fk(performance, get(col.name))))
		
	}
	
	correlations.cont <- function(col.name){	
		print("Inimigos:")
		print(with(enemy.topics.cont, cor.fk(contamination, get(col.name))))
		print("Aliados:")
		print(with(ally.topics.cont, cor.fk(contamination, get(col.name))))
	}
	offender.correlations.cont <- function(col.name){	
		print("Inimigos:")
		print(with(offender.enemy.topics.cont, cor.fk(contamination, get(col.name))))
		print("Aliados:")
		print(with(offender.ally.topics.cont, cor.fk(contamination, get(col.name))))
	}

```

#Perguntas!
Quais as perguntas que já foram respondidas?

* Como medir a performance de um jogador (e de um grupo de jogadores) na partida

* Como medir a contaminação tóxica de um time de jogadores em uma partida?
	+ Através do número de reports, assumindo que os reports indicam que um determinado jogador sentiu-se incomodado o suficiente pelo jogador tóxico ao ponto de realizar uma denúncia
	+ O fato do denunciante ter incluído um texto especificando a motivação de sua denúncia pode significar mais um fator para incuirmos no futuro no calculo da contaminação tóxica.
	
* Quais os diferentes topicos de conversa utilizados por times de League of legends?
	+ Tactics, tactics/pos, small talk, arguments, complaints, insults and taunts
	+ Esses padrões podem ser agrupados em dois grupos: um para tópicos positivos (tactics, tactics/pos, small talk) e outro para tópicos negativos (arguments, complaints, insults e taunts)
	
* Esses topicos relacionam-se de algum modo com a contaminação tóxica e a performance? Se sim, qual a relação? 
	+ Sim, os tópicos positivos no geral correlacinam-se inversamente com a contaminação, e positivamente com a performance, enquanto tópicos negativos 	corelacionam-se de maneira positiva com a contaminação, e de maneira negativa com a performance.
	
* Os tópicos utilizados pelo jogador tóxico influenciam a contaminação de algum modo? Se sim, como?
	+ Sim, os tópicos negativos utilizados pelo jogador tóxico influenciam a contaminação, afetando os times de maneiras distintas. Enquanto o time aliado é mais disposto a sofrer efeitos negativos de complaints e insultos feitos pelo jogador tóxico, o time inimigo é mais propenso a sofrer efeitos negativos de taunts.

#Comparação de jogadores não contaminados com os outros jogadores
##Distribuição:

Percentage of non-contaminated players from the total of enemy groups.
```{r}
nrow(groups[relation.offender=='enemy' & contamination == 0])*100/nrow(groups[relation.offender=='enemy'])
```

Percentage of non-contaminated players from the total of groups.
```{r}
nrow(groups[relation.offender=='enemy' & contamination == 0])*100/nrow(groups) 
```

##Comparação de médias:

###Não contaminados vs. contaminados:
Non-contaminated groups also presents higher average performance $(mean=0.120, sd=0.02)$ than contaminated groups $(mean=0.086,sd=0.03)$.
```{r}
med.t.test(groups[relation.offender=='enemy' & contamination == 0]$performance,
					 groups[relation.offender!='enemy' | contamination > 0]$performance)
```

###Não Contaminados vs. inimigos contaminados:
Non-contaminated groups also present higher average performance $(mean=0.120, sd=0.02)$ than contaminated $(mean=0.107, sd=0.03)$ enemy groups. 
```{r}
med.t.test(groups[relation.offender=='enemy' & contamination == 0]$performance,
					 groups[relation.offender=='enemy' & contamination > 0]$performance)
```

###Não Contaminados vs. Aliados contaminados:
And higher average performance $(mean=0.120, sd=0.02)$ than ally groups $(mean=0.084, sd=0.03)$ as well.
```{r}
med.t.test(groups[relation.offender=='enemy' & contamination == 0]$performance,
					 groups[relation.offender=='ally']$performance)
```

###Inimigos Contaminados vs. Aliados (performance):
We can also compare contaminated enemy groups and ally groups, and confirm that contaminated enemy groups $(mean=0.107, sd=0.03)$ have higher average peformance than allies$(mean=0.08, sd=0.03)$.
```{r}
med.t.test(groups[relation.offender=='enemy' & contamination > 0]$performance,
					 groups[relation.offender=='ally']$performance)

med.t.test(groups[relation.offender=='ally' & topic=='complaints']$performance,
groups[relation.offender=='ally' & topic!='complaints']$performance)

```
med.t.test(groups[relation offender=='ally' & topic=='complaints']$performance,
groups[relation.offender=='ally' & topic!='complaints']$performance)

###Inimigos Contaminados vs. Aliados (contaminação):
Finnaly, comparing the contamination index of contaminated enemy groups and ally groups, we see that the contaminated enemy groups $(mean=0.28, sd=0.15)$ still are less contaminated than the allies $(mean=0.30, sd=0.21)$ but with a small difference.
```{r}
med.t.test(groups[relation.offender=='enemy' & contamination > 0]$contamination,
					 groups[relation.offender=='ally']$contamination)
```

T-test's $p$ is $2.2*10^{16}$, for all these comparisons. 



#Distribuição dos tópicos(Positive and Negative):
##Por tipo de grupo:
Non-Contaminated:
```{r, echo=FALSE}
prop.table(summary(groups[relation.offender=='enemy' & contamination==0 & !is.na(topic)]$topic)) * 100
prop.table(summary(groups[relation.offender=='enemy' & contamination == 0 & !is.na(topic.2)]$topic.2)) * 100
```
Contaminated Enemies:
```{r, echo=FALSE}
prop.table(summary(groups[relation.offender=='enemy' & contamination > 0 & !is.na(topic)]$topic)) * 100
prop.table(summary(groups[relation.offender=='enemy' & contamination > 0 & !is.na(topic.2)]$topic.2)) * 100
```
Ally:
```{r, echo=FALSE}
prop.table(summary(groups[relation.offender=='ally' & !is.na(topic)]$topic)) * 100
prop.table(summary(groups[relation.offender=='ally' & !is.na(topic.2)]$topic.2)) * 100
```
Offender:
```{r, echo=FALSE}
prop.table(summary(groups[relation.offender=='offender' & !is.na(topic)]$topic)) * 100
prop.table(summary(groups[relation.offender=='offender' & !is.na(topic.2)]$topic.2)) * 100
```

##Por categoria de tópico
Dataset completo:
```{r, echo=FALSE}
prop.table(summary(groups[!is.na(topic)]$topic)) * 100
```

Positive Topics:
```{r, echo=FALSE}
prop.table(summary(groups[topic.2=='pos' & !is.na(topic)]$topic)) * 100
```

Negative Topics:
```{r, echo=FALSE}
prop.table(summary(groups[topic.2=='neg' & !is.na(topic)]$topic)) * 100
```




#Relacionamento entre topicos/grupos e performance/contaminação:
##Positive topics:
```{r, echo=FALSE}
topic = 'pos'

plt <- plot.topic.perf(topic) + labs(x='Group Performance', y='Groups w/ Positive Topics (%)')
save.plot('positive_perf.png',plt,w=6)
plt

plt <- plot.topic.cont(topic) + labs(x="Group Contamination", y='Groups w/ Positive Topics (%)')
save.plot('positive_cont.png',plt)
plt
```

####Correlações:
Performance:
```{r, echo=FALSE}
correlations.perf(topic)
```
Contaminação:
```{r, echo=FALSE}
correlations.cont(topic)
```

####Comparisons
```{r, echo=FALSE}
"Full"
med.t.test(groups[topic.2=='pos']$performance,groups[topic.2!='pos']$performance)
"Non-Contaminated"
med.t.test(groups[relation.offender=='enemy' & contamination==0 & topic.2=='pos']$performance,groups[relation.offender=='enemy' & contamination==0 & topic.2!='pos']$performance)
"Contaminated Enemies"
med.t.test(groups[relation.offender=='enemy' & contamination>0 & topic.2=='pos']$performance,groups[relation.offender=='enemy' & contamination>0 & topic.2!='pos']$performance)
"Allies"
med.t.test(groups[relation.offender=='ally' & topic.2=='pos']$performance,groups[relation.offender=='ally' & topic.2!='pos']$performance)
"Offenders"
med.t.test(groups[relation.offender=='offender' & topic.2=='pos']$performance,groups[relation.offender=='offender' & topic.2!='pos']$performance)
```
##Tactics-related(tactics + tactics.pos):
```{r, echo=FALSE}
topic = 'tactics.full'
plt <- plot.topic.perf(topic) + labs(x='Group Performance',y='Groups w/ Tactics-related Topics (%)')
save.plot('tactics_perf.png',plt,w=6)
plt

plt <- plot.topic.cont(topic) + labs(x="Group Contamination", y='Groups w/ Tactics-related Topics (%)')
save.plot('tactics_cont.png',plt)
plt
```

####Correlações:
Performance:
```{r, echo=FALSE}
correlations.perf(topic)
```
Contaminação:
```{r, echo=FALSE}
correlations.cont(topic)
```

####NhemNhemNhem
```{r, echo=FALSE}
mean(c(mean(matches[enemy.performance > 0.14 & enemy.contamination==0]$ally.performance), mean(matches[enemy.performance > 0.145 & enemy.contamination > 0]$ally.performance), mean(matches[ally.performance > 0.15]$enemy.performance)))

mean(c(mean(ally.topics.perf[performance > 0.15]$tactics.full),
mean(nc.topics.perf[values > 0.14]$tactics.full),
mean(ec.topics.perf[values > 0.145]$tactics.full)))

mean(topics.perf$tactics.full)



```

##Mood-related(tactics.pos + small talk):
```{r, echo=FALSE}
topic='mood'
plt <- plot.topic.perf(topic) + labs(x='Group Performance',y='Groups w/ Mood-related Topics (%)')
save.plot('mood_perf.png',plt,w=6)
plt

plt <- plot.topic.cont(topic) + labs(x="Group Contamination", y='Groups w/ Mood-related Topics (%)')
save.plot('mood_cont.png',plt)
plt
```

####Correlações:
Performance:
```{r, echo=FALSE}
correlations.perf('mood')
```
Contamination:
```{r, echo=FALSE}
correlations.cont('mood')
```

####Comparações:
#####Performance:
Non-contaminated:
```{r, echo=FALSE}
med.t.test(
	groups[relation.offender=='enemy' & contamination == 0 & (topic=='tactics.pos' | topic=='chit.chat')]$performance, 
	groups[relation.offender=='enemy' & contamination == 0 & (topic!='tactics.pos' & topic!='chit.chat')]$performance)
```
Contaminated enemy:
```{r, echo=FALSE}
med.t.test(
	groups[relation.offender=='enemy' & contamination > 0 & (topic=='tactics.pos' | topic=='chit.chat')]$performance, 
	groups[relation.offender=='enemy' & contamination > 0 & (topic!='tactics.pos' & topic!='chit.chat')]$performance)
```
Ally:
```{r, echo=FALSE}
med.t.test(
	groups[relation.offender=='ally' & (topic=='tactics.pos' | topic=='chit.chat')]$performance, 
	groups[relation.offender=='ally' & (topic!='tactics.pos' & topic!='chit.chat')]$performance)
```
Offender:
```{r, echo=FALSE}
med.t.test(
	groups[relation.offender=='offender' & (topic=='tactics.pos' | topic=='chit.chat')]$performance, 
	groups[relation.offender=='offender' & (topic!='tactics.pos' & topic!='chit.chat')]$performance)
```


##Negative Topics:
```{r, echo=FALSE}
plt <- plot.topic.perf('neg') + labs(x='Group Performance',y='Groups w/ Negative Topics (%)')
save.plot('negative_perf.png',plt,w=6)
plt

plt <- plot.topic.cont('neg') + labs(x="Group Contamination", y='Groups w/ Negative Topics (%)')
save.plot('negative_cont.png',plt)
plt
```

####Correlações:
```{r, echo=FALSE}
correlations.perf('neg')
print("For performance < 0.06:")
with(offender.topics.perf[performance < 0.06], cor.fk(performance, neg))
print("For performance >= 0.06:")
with(offender.topics.perf[performance >= 0.06], cor.fk(performance, neg))
```

####Comparisons:
####Comparisons
```{r, echo=FALSE}
"Full"
med.t.test(groups[topic.2=='neg']$performance,groups[topic.2!='neg']$performance)
"Non-Contaminated"
med.t.test(groups[relation.offender=='enemy' & contamination==0 & topic.2=='neg']$performance,groups[relation.offender=='enemy' & contamination==0 & topic.2!='neg']$performance)
"Contaminated Enemies"
med.t.test(groups[relation.offender=='enemy' & contamination>0 & topic.2=='neg']$performance,groups[relation.offender=='enemy' & contamination>0 & topic.2!='neg']$performance)
"Allies"
med.t.test(groups[relation.offender=='ally' & topic.2=='neg']$performance,groups[relation.offender=='ally' & topic.2!='neg']$performance)
"Offenders"
med.t.test(groups[relation.offender=='offender' & topic.2=='neg']$performance,groups[relation.offender=='offender' & topic.2!='neg']$performance)
```

##Arguments:
```{r, echo=FALSE}
topic='arguments'
plt <- plot.topic.perf(topic) + labs(x='Group Performance',y='Groups w/ Argument Topics (%)')
save.plot('arguments_perf.png',plt,w=6)
plt
plt <- plot.topic.cont(topic) + labs(x="Group Contamination", y='Groups w/ Argument Topics (%)')
save.plot('arguments_cont.png',plt)
plt
```

###Correlações:
Performance:
```{r, echo=FALSE}
correlations.perf(topic)
```
Contaminação
```{r, echo=FALSE}
correlations.perf(topic)
```
####Comparisons:
#####Performance:
Non-contaminated:
```{r, echo=FALSE}
med.t.test(
	groups[relation.offender=='enemy' & contamination == 0 & topic=='arguments']$performance, 
	groups[relation.offender=='enemy' & contamination == 0 & topic!='arguments']$performance)
```
Contaminated enemy:
```{r, echo=FALSE}
med.t.test(
	groups[relation.offender=='enemy' & contamination > 0 & topic=='arguments']$performance, 
	groups[relation.offender=='enemy' & contamination > 0 & topic!='arguments']$performance)
```
Ally:
```{r, echo=FALSE}
med.t.test(
	groups[relation.offender=='ally' & topic=='arguments']$performance, 
	groups[relation.offender=='ally' & topic!='arguments']$performance)
```
Offender:
```{r, echo=FALSE}
med.t.test(
	groups[relation.offender=='offender' & topic=='arguments']$performance, 
	groups[relation.offender=='offender' & topic!='arguments']$performance)

prop.table(summary(groups[topic.2=='neg']$topic))
```

####Minimum for non-contaminated and contaminated enemies.
```{r, echo=FALSE}
print("For non-contaminated")
min_args = min(nc.topics.perf$arguments)
inflex_perf = nc.topics.perf[arguments==min_args]$values
print(inflex_perf)
cor.fk(nc.topics.perf[values >= inflex_perf]$values, nc.topics.perf[values >= inflex_perf]$arguments)

print("For contaminated enemies")
min_args = min(ec.topics.perf$arguments)
inflex_perf = ec.topics.perf[arguments==min_args]$values
print(inflex_perf)
cor.fk(ec.topics.perf[values >= inflex_perf]$values, ec.topics.perf[values >= inflex_perf]$arguments)

print("For non-contaminated")
min_args = min(nc.topics.perf$arguments)
inflex_perf = nc.topics.perf[arguments==min_args]$values
print(inflex_perf)
cor.fk(nc.topics.perf[values < inflex_perf]$values, nc.topics.perf[values < inflex_perf]$arguments)

print("For contaminated enemies")
min_args = min(ec.topics.perf$arguments)
inflex_perf = ec.topics.perf[arguments==min_args]$values
print(inflex_perf)
cor.fk(ec.topics.perf[values < inflex_perf]$values, ec.topics.perf[values < inflex_perf]$arguments)

med.t.test(
	groups[relation.offender=='enemy' & contamination>0 & performance > inflex_perf]$contamination,
	groups[relation.offender=='enemy' & contamination>0]$contamination
	)

med.t.test(
	(matches[enemy.performance > inflex_perf]$ally.performance + matches[enemy.performance > inflex_perf]$offender.performance)/2,
	matches[enemy.performance > inflex_perf]$enemy.performance
)



```
##Complaints:
```{r, echo=FALSE}
topic='complaints'

plt <- plot.topic.perf(topic) + labs(x='Group Performance',y='Groups w/ Complaint Topics (%)')
save.plot('complaints_perf.png',plt,w=6)
plt

plt <- plot.topic.cont(topic) + labs(x="Group Contamination", y='Groups w/ Complaint Topics (%)')
save.plot('complaints_cont.png',plt)
plt
```

####Offender's peak:
```{r, echo=FALSE}
max.compl = max(offender.topics.perf$complaints)
max.perf = offender.topics.perf[complaints==max.compl]$performance
print(max.perf)

cor.fk(offender.topics.perf[performance <= max.perf]$performance, offender.topics.perf[performance <= max.perf]$complaints)

cor.fk(offender.topics.perf[performance > max.perf]$performance, offender.topics.perf[performance > max.perf]$complaints)
```


####Correlações:
```{r, echo=FALSE}
correlations.perf(topic)
```

```{r, echo=FALSE}
correlations.cont(topic)
```

####Comparisons:
Non-contaminated:
```{r, echo=FALSE}
med.t.test(groups[relation.offender=='enemy' & contamination == 0 & topic=='complaints']$performance,
					 groups[relation.offender=='enemy' & contamination == 0 & topic!='complaints']$performance)
```
Contaminated enemies:
```{r, echo=FALSE}
med.t.test(groups[relation.offender=='enemy' & contamination > 0 & topic=='complaints']$performance,
					 groups[relation.offender=='enemy' & contamination > 0 & topic!='complaints']$performance)
```
Allies:
```{r, echo=FALSE}
med.t.test(groups[relation.offender=='ally' & topic=='complaints']$performance, 
					 groups[relation.offender=='ally' & topic!='complaints']$performance)
```
Offenders:
```{r, echo=FALSE}
med.t.test(groups[relation.offender=='offender' & topic=='complaints']$performance,
					 groups[relation.offender=='offender' & topic!='complaints']$performance)
```

####Comparisons in negative topics:

##Insults:
```{r, echo=FALSE}
topic = 'insults'
plt <- plot.topic.perf(topic) + labs(x='Group Performance',y='Groups w/ Insult Topics (%)')
save.plot('insults_perf.png',plt,w=6)
plt

plt <- plot.topic.cont(topic) + labs(x='Group Contamination',y='Groups w/ Insult Topics (%)')
save.plot('insults_cont.png',plt)
plt
```
####Correlações:
Performance:
```{r, echo=FALSE}
correlations.perf(topic)
```
Contamination:
```{r, echo=FALSE}
correlations.cont(topic)
```

####Offender's peak
```{r, echo=FALSE}
max_insults = max(offender.topics.perf$insults)
inflex_perf = max(offender.topics.perf[insults==max_insults]$performance)
inflex_perf
cor.fk(offender.topics.perf[performance < inflex_perf]$performance, offender.topics.perf[performance < inflex_perf]$insults)
cor.fk(offender.topics.perf[performance >= inflex_perf]$performance, offender.topics.perf[performance >= inflex_perf]$insults)
```

####Comparisons:
Non-contaminated:
```{r, echo=FALSE}
med.t.test(groups[relation.offender=='enemy' & contamination == 0 & topic=='insults']$performance,
					 groups[relation.offender=='enemy' & contamination == 0 & topic!='insults']$performance)
```
Contaminated enemies:
```{r, echo=FALSE}
med.t.test(groups[relation.offender=='enemy' & contamination > 0 & topic=='insults']$performance,
					 groups[relation.offender=='enemy' & contamination > 0 & topic!='insults']$performance)
```
Allies:
```{r, echo=FALSE}
med.t.test(groups[relation.offender=='ally' & topic=='insults']$performance, 
					 groups[relation.offender=='ally' & topic!='insults']$performance)
```

Offenders:
```{r, echo=FALSE}
med.t.test(groups[relation.offender=='offender' & topic=='complaints']$performance,
					 groups[relation.offender=='offender' & topic!='complaints']$performance)
```

##Taunts:
```{r, echo=FALSE}
topic='provoking'
plt <- plot.topic.perf(topic) + labs(x='Group Performance',y='Groups w/ Taunts Topics (%)')
save.plot('taunts_perf.png',plt,w=6)
plt

plt <- plot.topic.cont(topic) + labs(x='Group Contamination',y='Groups w/ Taunts Topics (%)')
save.plot('taunts_cont.png',plt)
plt
```

####Correlações:
Performance:
```{r, echo=FALSE}
correlations.perf(topic)
```
Contaminação:
```{r, echo=FALSE}
correlations.cont(topic)
```

####Comparisons:
Non-contaminated:
```{r, echo=FALSE}
med.t.test(
	groups[relation.offender=='enemy' & contamination == 0 & topic=='provoking']$performance, 
	groups[relation.offender=='enemy' & contamination == 0 & topic!='provoking']$performance)
```

Contaminated enemy:
```{r, echo=FALSE}
med.t.test(
	groups[relation.offender=='enemy' & contamination > 0 & topic=='provoking']$performance, 
	groups[relation.offender=='enemy' & contamination > 0 & topic!='provoking']$performance)
```

Ally:
```{r, echo=FALSE}
med.t.test(
	groups[relation.offender=='ally' & topic=='provoking']$performance, 
	groups[relation.offender=='ally' & topic!='provoking']$performance)
```

Offender:
```{r, echo=FALSE}
med.t.test(
	groups[relation.offender=='offender' & topic=='provoking']$performance, 
	groups[relation.offender=='offender' & topic!='provoking']$performance)

prop.table(summary(groups[topic.2=='neg']$topic))
```


##Conclusions(Positive):
Complaints & Insults : Offenders with low performance tends to complain more, and complain about his own team.
Complaints:
```{r}
#summary(groups$performance)
#summary(offender.topics.perf[performance > 0.094]$complaints)
#summary(offender.topics.perf[performance <= 0.094]$complaints)
summary(matches$offender.team)
summary(matches[offender.performance > 0.094 | offender.groups!='complaints']$offender.team)
summary(matches[offender.performance <= 0.094 & offender.groups=='complaints']$offender.team)
```
Enemy teams taunts more on high contamination and low performance as a response to the opposing team taunts.

Comparison betweeen the mean contamination of each topic:
General:
Positive Topics:
```{r}
	'Positive:'
	mean(groups[topic.2=='pos']$contamination,na.rm=TRUE)
	'Tactics:'
	mean(groups[topic.2=='pos' & (topic=='tactics')]$contamination,na.rm=TRUE)
	'Tactics.pos:'
	mean(groups[topic.2=='pos' & (topic=='tactics.pos')]$contamination,na.rm=TRUE)
	'Small Talk:'
	mean(groups[topic.2=='pos' & (topic=='chit.chat')]$contamination,na.rm=TRUE)
	'Tactics.all:'
	mean(groups[topic.2=='pos' & (topic=='tactics' | topic=='tactics.pos')]$contamination,na.rm=TRUE)
	'Mood:'
	mean(groups[topic.2=='pos' & (topic=='chit.chat' | topic=='tactics.pos')]$contamination,na.rm=TRUE)
```
Positive Topics [Ally]:
```{r}
	'Positive:'
	mean(groups[relation.offender=='ally' & topic.2=='pos']$contamination,na.rm=TRUE)
	'Tactics:'
	mean(groups[relation.offender=='ally' & topic.2=='pos' & (topic=='tactics')]$contamination,na.rm=TRUE)
	'Tactics.pos:'
	mean(groups[relation.offender=='ally' & topic.2=='pos' & (topic=='tactics.pos')]$contamination,na.rm=TRUE)
	'Small Talk:'
	mean(groups[relation.offender=='ally' & topic.2=='pos' & (topic=='chit.chat')]$contamination,na.rm=TRUE)
	'Tactics.all:'
	mean(groups[relation.offender=='ally' & topic.2=='pos' & (topic=='tactics' | topic=='tactics.pos')]$contamination,na.rm=TRUE)
	'Mood:'
	mean(groups[relation.offender=='ally' & topic.2=='pos' & (topic=='chit.chat' | topic=='tactics.pos')]$contamination,na.rm=TRUE)
```
Positive Topics[Non Contaminated Enemies]:
```{r}
	'Positive:'
	mean(groups[relation.offender=='enemy' & topic.2=='pos']$contamination,na.rm=TRUE)
	'Tactics:'
	mean(groups[relation.offender=='enemy' & topic.2=='pos' & (topic=='tactics')]$contamination,na.rm=TRUE)
	'Tactics.pos:'
	mean(groups[relation.offender=='enemy' & topic.2=='pos' & (topic=='tactics.pos')]$contamination,na.rm=TRUE)
	'Small Talk:'
	mean(groups[relation.offender=='enemy' & topic.2=='pos' & (topic=='chit.chat')]$contamination,na.rm=TRUE)
	'Tactics.all:'
	mean(groups[relation.offender=='enemy' & topic.2=='pos' & (topic=='tactics' | topic=='tactics.pos')]$contamination,na.rm=TRUE)
	'Mood:'
	mean(groups[relation.offender=='enemy' & topic.2=='pos' & (topic=='chit.chat' | topic=='tactics.pos')]$contamination,na.rm=TRUE)
```
Negative Topics
```{r}
	'Negative:'
	mean(groups[topic.2=='neg']$contamination,na.rm=TRUE)
```

#Relacionar contaminação com a presença do ofensor no 'all chat'
```{r}
med.t.test(matches[offender.all == 0]$enemy.contamination, matches[offender.all > 0]$enemy.contamination)
med.t.test(matches[offender.all == 0]$ally.contamination, matches[offender.all > 0]$ally.contamination)
```
<!--
	#TODO: Relacionar tópico dos ofensores com as palavras utilizadas nas denúncias destes.
	#Interessante: Níveis anormalmente altos de performance só se situam em grupos contaminadas.
	
	#TODO: Jogadores não contaminados x topicos do ofensor
	#TODO: Levar em consideração empatia(casos em que o time aliado pede para o time inimigo reportar)
	#TODO: usar um classificador para verificar quais chats batem com quais clusters. 
-->

## Non-contaminated groups dominate the 25% high performance scores.
```{r}
	x = summary(groups$performance)
	full = nrow(groups[performance >= x[5]])
	part = nrow(groups[performance >= x[5] & relation.offender=='enemy' & contamination == 0])
	print("Non-contaminated")
	print(part/full)
	part = nrow(groups[performance >= x[5] & relation.offender=='enemy' & contamination > 0])
	print("Contaminated enemies")
	print(part/full)
	part = nrow(groups[performance >= x[5] & relation.offender=='ally'])
	print("Allies")
	print(part/full)
	print("Offenders")
	part = nrow(groups[performance >= x[5] & relation.offender=='offender'])
	print(part/full)
```


#Alvos do ofensor em certos tópicos negativos

##Presença do ofensor no 'all' chat aumenta contaminação no time inimigo
```{r}
summary(matches[offender.all==0]$enemy.contamination)
summary(matches[offender.all >0]$enemy.contamination)

part=nrow(matches[offender.all==0])
full=nrow(matches)
part/full
```

##Insults
Podemos ver que a média da atividade do ofensor no canal 'all' quando este predominantemente insulta $(mean=0.20)$ é menor do que a média de atividade na predominância de outros tópicos $(mean=0.32)$. Isso mostra que o ofensor dá menos atenção ao grupo inimigo em casos de insulto. Não temos confirmação de que o ofensor foca seus ataques no grupo aliado através da atividade no chat. Contudo, analisando as palavras utilizadas pelo ofensor e a relação entre a quantidade de insultos realizadas pelo ofensor e a contaminação, fica claro que o time aliado é consideravelmente afetado por estes insultos.

```{r}
x <- matches[offender.groups=='insults']$offender.all
not.x <- matches[offender.groups!='insults']$offender.all
t.test(x,not.x)
```

```{r}
x <- matches[offender.groups=='insults']$offender.team
not.x <- matches[offender.groups!='insults']$offender.team
t.test(x,not.x)
```
##Taunts
A média da atividade do ofensor no canal 'all' quando este predominantemente provoca $(mean=0.45)$, é significativamente superior $(p < 2.2*10^{16})$ a média da atividade do ofensor no 'all' quando outros tópicos são predominantes $(mean=0.29)$. isso mostra que em casos de provocação, o ofensor foca no time inimigo em detrimento do time aliado, que mostra atividade significativamente mais baixa $(p < 2.2*10^{16})$ por parte do ofensor em casos onde provocação é predominante $(mean=0.68)$ do que em outros casos $(mean=1.01)$.
```{r}
x <- matches[offender.groups=='provoking']$offender.all
not.x <- matches[offender.groups!='provoking']$offender.all
t.test(x,not.x)
```
```{r}
x <- matches[offender.groups=='provoking']$offender.team
not.x <- matches[offender.groups!='provoking']$offender.team
t.test(x,not.x)
```

Podemos replicar esse experimento para os tópicos negativos restantes:

##Complaints
Diferença estatisticamente significativa em ambos, logo, consideramos que houve um 'empate técnico'. Contudo, a diferença real no 'team' é bem significativa $mean=1.11$ para grupos com complaints, $mean=0.95$ para grupos sem complaints. Isso significa que ofensores que reclamam alvejam o time aliado mais do que o normal.
```{r}
x <- matches[offender.groups=='complaints']$offender.all
not.x <- matches[offender.groups!='complaints']$offender.all
t.test(x,not.x)
```
```{r}
x <- matches[offender.groups=='complaints']$offender.team
not.x <- matches[offender.groups!='complaints']$offender.team
t.test(x,not.x)
```

<!-- ## R Markdown -->

<!-- This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>. -->

<!-- When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this: -->

<!-- ```{r cars} -->
<!-- summary(cars) -->
<!-- ``` -->

<!-- ## Including Plots -->

<!-- You can also embed plots, for example: -->

<!-- ```{r pressure, echo=FALSE} -->
<!-- plot(pressure) -->
<!-- ``` -->

<!-- Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot. -->

```{r}
# plt <- plot.topic.perf('neg') + labs(x='Group Performance',y='Groups w/ Negative Topics (%)')
# save.plot('negative_perf.png',plt,w=6)
# plt <- plot.topic.perf('arguments') + labs(x='Group Performance',y='Groups w/ Argument Topics (%)')
# save.plot('arguments_perf.png',plt,w=6)
# plt <- plot.topic.perf('complaints') + labs(x='Group Performance',y='Groups w/ Complaint Topics (%)')
# save.plot('complaints_perf.png',plt,w=6)
# plt <- plot.topic.perf('insults') + labs(x='Group Performance',y='Groups w/ Insult Topics (%)')
# save.plot('insults_perf.png',plt,w=6)
# plt <- plot.topic.perf('provoking') + labs(x='Group Performance',y='Groups w/ Taunts Topics (%)')
# save.plot('taunts_perf.png',plt,w=6)
# plt <- plot.topic.cont('neg') + labs(x="Group Contamination", y='Groups w/ Negative Topics (%)')
# save.plot('negative_cont.png',plt)
# plt <- plot.topic.cont('arguments') + labs(x="Group Contamination", y='Groups w/ Argument Topics (%)')
# save.plot('arguments_cont.png',plt)
# plt <- plot.topic.cont('complaints') + labs(x="Group Contamination", y='Groups w/ Complaint Topics (%)')
# save.plot('complaints_cont.png',plt)
# plt <- plot.topic.cont('insults') + labs(x="Group Contamination", y='Groups w/ Insult Topics (%)')
# save.plot('insults_cont.png',plt)
# plt <- plot.topic.cont('provoking') + labs(x="Group Contamination", y='Groups w/ Taunt Topics (%)')
# save.plot('provoking_cont.png',plt)
```

#Tabela de Outcomes(Passar para um arquivo .R eventualmente)
```{r, echo=FALSE}
# outcomes <- players[,.(case,match,relation.offender,outcome),.(case,match,relation.offender,outcome)][,.(case,match,relation.offender,outcome)]
# outcomes <- outcomes[outcome=='Win']
# outcomes <- rbind(outcomes,
# 							rbind(outcomes[relation.offender=='enemy'][,relation.offender:='ally'][,outcome:='Loss'],
# 								outcomes[relation.offender=='ally'][,relation.offender:='enemy'][,outcome:='Loss'])
# )
# outcomes <- rbind(outcomes,outcomes[relation.offender=='ally'][,relation.offender:='offender'])
# 
# setkey(outcomes,case,match,relation.offender)
# 
# groups <- groups[outcomes]
# groups$outcome <- factor(groups$outcome)
```


#Adicionando ally e enemy targets a matches(Passar para o groups.R eventualmente)
```{r, echo=FALSE}
	# matches <- matches[groups[relation.offender=='ally',.(case,match,num.all,num.team)]]
	# matches <- matches[,ally.chat.all := num.all/(time.played/60)][,ally.chat.team := num.team/(time.played/60)]
	# matches$num.all <- NULL; matches$num.team <- NULL;
	# 
	# matches <- matches[groups[relation.offender=='enemy',.(case,match,num.all,num.team)]]
	# matches <- matches[,enemy.chat.all := num.all/(time.played/60)][,enemy.chat.team := num.team/(time.played/60)]
	# matches$num.all <- NULL; matches$num.team <- NULL;
```


#Insults and Taunts - Some negative topics does not affect its own team.
```{r}
summary(matches[ally.groups=='provoking' & ally.chat.all > 0 & ally.chat.team == 0]$enemy.contamination)
summary(matches[ally.groups=='insults' & ally.chat.all > 0 & ally.chat.team == 0]$enemy.contamination)
summary(matches[enemy.groups=='insults' & enemy.chat.all > 0 & enemy.chat.team == 0]$ally.contamination)
summary(matches[enemy.groups=='provoking' & enemy.chat.all > 0 & enemy.chat.team == 0]$ally.contamination)

#summary(matches[enemy.groups=='insults' & !(enemy.chat.all > 0 & enemy.chat.team == 0)]$enemy.contamination)

```


#Offender Topics

##Negative Topics
```{r, echo=FALSE}
column <- 'neg'

plt <- plot.topic.offender.perf(column) + labs(y="Offenders w/ Negative Topics (%)", x='Other Groups Performance')
save.plot('offender-negative-perf.png',plt,w=6)
plt

plt <- plot.topic.offender.cont(column) + labs(y="Offenders w/ Negative Topics (%)", x='Ally & Enemy Contamination')
save.plot('offender-negative-cont.png',plt,w=6)
plt
```
###Correlations
Performance:
```{r}
offender.correlations.perf(column)
```
Contamination:
```{r}
offender.correlations.cont(column)
```


##Complaints
```{r, echo=FALSE}
column <- 'complaints'

plt <- plot.topic.offender.perf(column) + labs(y="Offenders w/ Complaints Topics (%)", x='Other Groups Performance')
save.plot('offender-complaints-perf.png',plt,w=6)
plt

plt <- plot.topic.offender.cont(column) + labs(y="Offenders w/ Complaints Topics (%)", x='Ally & Enemy Contamination')
save.plot('offender-complaints-cont.png',plt)
plt
```
###Correlations
Performance:
```{r}
offender.correlations.perf(column)
```
Contamination:
```{r}
offender.correlations.cont(column)
```



##Arguments
```{r, echo=FALSE}
column <- 'arguments'

plt <- plot.topic.offender.perf(column) + labs(y="Offenders w/ Arguments Topics (%)", x='Other Groups Performance')
save.plot('offender-arguments-perf.png',plt,w=6)
plt

plt <- plot.topic.offender.cont(column) + labs(y="Offenders w/ Arguments Topics (%)", x='Ally & Enemy Contamination')
save.plot('offender-arguments-cont.png',plt,w=6)
plt
```
###Correlations
Performance:
```{r}
offender.correlations.perf(column)
```
Contamination:
```{r}
offender.correlations.cont(column)
```


##Insults
```{r, echo=FALSE}
column <- 'insults'

plt <- plot.topic.offender.perf(column) + labs(y="Offenders w/ Insults Topics (%)", x='Other Groups Performance')
save.plot('offender-insults-perf.png',plt,w=6)
plt

plt <- plot.topic.offender.cont(column) + labs(y="Offenders w/ Insults Topics (%)", x='Ally & Enemy Contamination')
save.plot('offender-insults-cont.png',plt,w=6)
plt
```
###Correlations
Performance:
```{r}
offender.correlations.perf(column)
```
Contamination:
```{r}
offender.correlations.cont(column)
```


##Taunts
```{r, echo=FALSE}
column <- 'provoking'

plt <- plot.topic.offender.perf(column) + labs(y="Offenders w/ Taunts Topics (%)", x='Other Groups Performance')
save.plot('offender_taunts_perf.png',plt,w=6)
plt

plt <- plot.topic.offender.cont(column) + labs(y="Offenders w/ Taunts Topics (%)", x='Ally & Enemy Contamination')
save.plot('offender_taunts_cont.png',plt)
plt
```

###Correlations

Performance:
```{r}
offender.correlations.perf(column)
```
Contamination:
```{r}
offender.correlations.cont(column)
```

#KDA X Performance
##KDA:
```{r, echo=FALSE}
	x <- summary(players$kda)
```
Central 50\%:
```{r}
prop.table(summary(players[kda > x[2] & kda < x[5] & outcome != 'Leave']$outcome))
```
Lower 25\%:
```{r}
prop.table(summary(players[kda <= x[2] & outcome != 'Leave']$outcome))
```
Upper 25\%:
```{r}
prop.table(summary(players[kda >= x[5] & outcome != 'Leave']$outcome))
```

Means:
KDA full summary:
```{r}
summary(players$kda)
```
Winners kda summary:
```{r}
summary(players[outcome=='Win']$kda)
```
Losers kda summary:
```{r}
summary(players[outcome=='Loss']$kda)
```

##Performance:
```{r, echo=FALSE}
x <- summary(players$performance)
```
Central 50\%:
```{r}
prop.table(summary(players[performance > x[2] & performance < x[5] & outcome != 'Leave']$outcome))
```
Lower 25\%:
```{r}
prop.table(summary(players[performance <= x[2] & outcome != 'Leave']$outcome))
```
Upper 25\%:
```{r}
prop.table(summary(players[performance >= x[5] & outcome != 'Leave']$outcome))
```

Means:
Performance full summary:
```{r}
summary(players$performance)
```
Winners performance summary:
```{r}
summary(players[outcome=='Win']$performance)
```
Losers performance summary:
```{r}
summary(players[outcome=='Loss']$performance)
```



##Comparison


#Group performance:
```{r, echo=FALSE}
x <- summary(groups[relation.offender != 'offender']$performance)
```
Central 50\%:
```{r}
prop.table(summary(groups[performance > x[2] & performance < x[5] & outcome != 'Leave' & relation.offender != 'offender']$outcome))
```
Lower 25\%:
```{r}
prop.table(summary(groups[relation.offender != 'offender' & performance <= x[2] & outcome != 'Leave']$outcome))
```
Upper 25\%:
```{r}
prop.table(summary(groups[relation.offender != 'offender' & performance >= x[5] & outcome != 'Leave']$outcome))
```

Means:
Performance full summary:
```{r}
summary(groups[relation.offender != 'offender']$performance)
```
Winners performance summary:
```{r}
summary(groups[relation.offender != 'offender' & outcome=='Win']$performance)
```
Losers performance summary:
```{r}
summary(groups[relation.offender != 'offender' & outcome=='Loss']$performance)
```


#Plots
 Codigo de salvamento dos plots 
```{r, echo=FALSE}

topic = 'pos'

plt <- plot.topic.perf(topic) + labs(x='Group Performance', y='Groups w/ Positive Topics (%)')
save.plot('positive_perf.png',plt,w=6)
plt

plt <- plot.topic.cont(topic) + labs(x="Group Contamination", y='Groups w/ Positive Topics (%)')
save.plot('positive_cont.png',plt)
plt

topic = 'tactics.full'
plt <- plot.topic.perf(topic) + labs(x='Group Performance',y='Groups w/ Tactics-related Topics (%)')
save.plot('tactics_perf.png',plt,w=6)
plt

plt <- plot.topic.cont(topic) + labs(x="Group Contamination", y='Groups w/ Tactics-related Topics (%)')
save.plot('tactics_cont.png',plt)
plt

topic='mood'
plt <- plot.topic.perf(topic) + labs(x='Group Performance',y='Groups w/ Mood-related Topics (%)')
save.plot('mood_perf.png',plt,w=6)
plt

plt <- plot.topic.cont(topic) + labs(x="Group Contamination", y='Groups w/ Mood-related Topics (%)')
save.plot('mood_cont.png',plt)
plt

topic='neg'
plt <- plot.topic.perf(topic) + labs(x='Group Performance',y='Groups w/ Negative Topics (%)')
save.plot('negative_perf.png',plt,w=6)
plt

plt <- plot.topic.cont(topic) + labs(x="Group Contamination", y='Groups w/ Negative Topics (%)')
save.plot('negative_cont.png',plt)
plt

topic='complaints'

plt <- plot.topic.perf(topic) + labs(x='Group Performance',y='Groups w/ Complaint Topics (%)')
save.plot('complaints_perf.png',plt,w=6)
plt

plt <- plot.topic.cont(topic) + labs(x="Group Contamination", y='Groups w/ Complaint Topics (%)')
save.plot('complaints_cont.png',plt)
plt

topic='arguments'
plt <- plot.topic.perf(topic) + labs(x='Group Performance',y='Groups w/ Argument Topics (%)')
save.plot('arguments_perf.png',plt,w=6)
plt
plt <- plot.topic.cont(topic) + labs(x="Group Contamination", y='Groups w/ Argument Topics (%)')
save.plot('arguments_cont.png',plt)
plt

topic = 'insults'
plt <- plot.topic.perf(topic) + labs(x='Group Performance',y='Groups w/ Insult Topics (%)')
save.plot('insults_perf.png',plt,w=6)
plt

plt <- plot.topic.cont(topic) + labs(x='Group Contamination',y='Groups w/ Insult Topics (%)')
save.plot('insults_cont.png',plt)
plt

topic='provoking'
plt <- plot.topic.perf(topic) + labs(x='Group Performance',y='Groups w/ Taunts Topics (%)')
save.plot('taunts_perf.png',plt,w=6)
plt

plt <- plot.topic.cont(topic) + labs(x='Group Contamination',y='Groups w/ Taunts Topics (%)')
save.plot('taunts_cont.png',plt)
plt

column <- 'neg'

plt <- plot.topic.offender.perf(column) + labs(y="Offenders w/ Negative Topics (%)", x='Other Groups Performance')
save.plot('offender_negative_perf.png',plt,w=6)
plt

plt <- plot.topic.offender.cont(column) + labs(y="Offenders w/ Negative Topics (%)", x='Ally & Enemy Contamination')
save.plot('offender_negative_cont.png',plt)
plt

column <- 'complaints'

plt <- plot.topic.offender.perf(column) + labs(y="Offenders w/ Complaints Topics (%)", x='Other Groups Performance')
save.plot('offender_complaints_perf.png',plt,w=6)
plt

plt <- plot.topic.offender.cont(column) + labs(y="Offenders w/ Complaints Topics (%)", x='Ally & Enemy Contamination')
save.plot('offender_complaints_cont.png',plt)
plt

column <- 'arguments'

plt <- plot.topic.offender.perf(column) + labs(y="Offenders w/ Arguments Topics (%)", x='Other Groups Performance')
save.plot('offender_arguments_perf.png',plt,w=6)
plt

plt <- plot.topic.offender.cont(column) + labs(y="Offenders w/ Arguments Topics (%)", x='Ally & Enemy Contamination')
save.plot('offender_arguments_cont.png',plt,w=6)
plt

column <- 'insults'

plt <- plot.topic.offender.perf(column) + labs(y="Offenders w/ Insults Topics (%)", x='Other Groups Performance')
save.plot('offender_insults_perf.png',plt,w=6)
plt

plt <- plot.topic.offender.cont(column) + labs(y="Offenders w/ Insults Topics (%)", x='Ally & Enemy Contamination')
save.plot('offender_insults_cont.png',plt)
plt

column <- 'provoking'

plt <- plot.topic.offender.perf(column) + labs(y="Offenders w/ Taunts Topics (%)", x='Other Groups Performance')
save.plot('offender_taunts_perf.png',plt,w=6)
plt

plt <- plot.topic.offender.cont(column) + labs(y="Offenders w/ Taunts Topics (%)", x='Ally & Enemy Contamination')
save.plot('offender_taunts_cont.png',plt)
plt
```